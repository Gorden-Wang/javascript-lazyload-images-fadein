/*
    version: 2.0.0
    date: 2016-04-30
    author: 狼族小狈
    github：https://github.com/1340641314/fors
*/
!function(t){"function"==typeof define&&"object"==typeof define.amd&&define.amd?define(function(){return t}):"undefined"!=typeof module&&module.exports?module.exports=t:window.LazyloadImg=t}(function(t){"use strict";function e(t){this.el="[data-src]",this.top=0,this.right=0,this.bottom=0,this.left=0,this.load=function(t){},this.error=function(t){},this.qriginal=!1,this.transparent="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAQAAAAECAYAAACp8Z5+AAAACXBIWXMAAA7EAAAOxAGVKw4bAAAAEklEQVR42mP4//8/AzJmIF0AAHImL9Fd8LZHAAAAAElFTkSuQmCC";for(var e in t)this[e]=t[e];this.init()}return e.prototype.init=function(){this.createStyle();var t=this;this.src=function(){return/\[data-([a-z]+)\]$/.exec(t.el)[1]||"src"}();for(var e=["DOMContentLoaded","load","click","touchstart","touchend","haschange","online","pageshow","popstate","resize","storage","mousewheel","scroll"],n=0;n<e.length;n++)document.addEventListener(e[n],this.eachDOM.bind(this),!1)},e.prototype.createStyle=function(){var t=document.getElementById("LazyloadImg-style");return t?!1:(t=document.createElement("style"),t.id="LazyloadImg-style",t.type="text/css",t.innerHTML="            .LazyloadImg-qriginal {                -webkit-transition: none!important;                -moz-transition: none!important;                -o-transition: none!important;                transition: none!important;                background-size: cover!important;                background-position: center center!important;                background-repeat: no-repeat!important;            }        ",void document.querySelector("head").appendChild(t))},e.prototype.eachDOM=function(){for(var t=document.querySelectorAll(this.el),e=[],n=0;n<t.length;n++)this.testMeet(t[n])===!0&&e.push(t[n]);for(var n=0;n<e.length;n++)this.loadImg(e[n])},e.prototype.testMeet=function(t){var e=t.getBoundingClientRect(),n=t.offsetWidth,i=t.offsetHeight,r=window.innerWidth,o=window.innerHeight,a=!(e.right-this.left<=0&&e.left+n-this.left<=0||e.left+this.right>=r&&e.right+this.right>=n+r),s=!(e.bottom-this.top<=0&&e.top+i-this.top<=0||e.top+this.bottom>=o&&e.bottom+this.bottom>=i+o);return 0!=t.width&&0!=t.height&&a&&s?!0:!1},e.prototype.loadImg=function(t){var e=this,n=t.dataset[this.src],i=new Image;i.src=n,i.addEventListener("load",function(){return e.qriginal?(t.style.width=t.width+"px",t.style.height=t.height+"px",t.src=e.transparent,t.className+=" LazyloadImg-qriginal",t.style.backgroundImage="url("+i.src+")"):t.src=i.src,delete t.dataset[e.src],e.load.call(e,t)},!1),i.addEventListener("error",function(){return e.error.call(e,t)},!1)},new e(t)});